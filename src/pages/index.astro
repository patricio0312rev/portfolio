---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { Navbar } from "@/components/layout/Navbar";
import { Footer } from "@/components/layout/Footer";
import { Hero } from "@/components/sections/Hero";
import { About } from "@/components/sections/About";
import { Experience } from "@/components/sections/Experience";
import { Education } from "@/components/sections/Education";
import { Awards } from "@/components/sections/Awards";
import { Publications } from "@/components/sections/Publications";
import { Contact } from "@/components/sections/Contact";
import { PersonalProjects } from "@/components/sections/PersonalProjects";

import { ScrollProgressBar } from "@/components/ui/ScrollProgressBar";
import { FloatingContactMe } from "@/components/ui/FloatingContactMe";

import projectsDataRaw from "@/data/personal-projects.json";
import type { PersonalProject } from "@/types";

import type {
  Job,
  Education as EducationType,
  Award,
  Publication,
} from "@/types";

import jobsDataRaw from "@/data/jobs.json";
import educationDataRaw from "@/data/education.json";
import awardsDataRaw from "@/data/awards.json";
import publicationsDataRaw from "@/data/publications.json";

const jobsData = jobsDataRaw as unknown as Job[];
const educationData = educationDataRaw as unknown as EducationType[];
const awardsData = awardsDataRaw as unknown as Award[];
const publicationsData = publicationsDataRaw as unknown as Publication[];

const jobs: Job[] = jobsData
  .slice()
  .sort(
    (a, b) => new Date(b.startDate).getTime() - new Date(a.startDate).getTime()
  );

const personalProjects = projectsDataRaw as unknown as PersonalProject[];
const education: EducationType[] = educationData.slice();

const awards: Award[] = awardsData
  .slice()
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

const publications: Publication[] = publicationsData
  .slice()
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());
---

<BaseLayout>
  <Navbar client:load />

  <ScrollProgressBar client:load />
  <FloatingContactMe client:load />

  <main>
    <Hero client:load />
    <About client:visible />

    <div id="floating-contact-start" class="h-px w-full" aria-hidden="true">
    </div>

    <Experience jobs={jobs} client:visible />
    <PersonalProjects projects={personalProjects} client:visible />
    <Education education={education} client:visible />
    <Awards awards={awards} client:visible />

    <div id="floating-contact-end" class="h-px w-full" aria-hidden="true"></div>

    <Publications publications={publications} client:visible />
    <Contact client:visible />
  </main>

  <Footer />
</BaseLayout>
